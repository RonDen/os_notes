# 进程线程会议纪要

## 开场白

问题易于回答，但理解深入很难。

先过问题，后过代码。

有一部分代码，内嵌汇编，宏定义，需要再理解。

## 过问题

### 2

EPROCESS用户进程，E是什么含义？

XV6 64位 proc 数组，后续代码里详细看。

### 3

Linux 6/7 种状态？

进程可能出现孤儿状态。

为什么要有僵尸状态？

父进程退出，子进程会被init领养？XV6是否支持？

僵尸进程与孤儿进程区别？僵尸进程与孤儿进程的危害？

僵尸进程和unused进程区别？

Linux的状态可以加张图。

### 4

设计的目的：不是提高效率，就是提高安全性。

僵尸状态是因为无法立即回收，需要等待父进程清理。

### 5

XV6即有fork又有alloc。

限制最大进程数是因为系统资源有限。

进程切换后续看代码。

多CPU是多个调度队列吗？

### 6

内核态和用户态如何标记？区别是指令级别的吗？

## 看代码

>部分内存管理相关的代码没有涉及

### types.h

pde: page directory entry

### param.h

一个block多大？disk block 和页对应吗？

### memlayout.h

v2p为什么可以直接减常数？答：启动操作系统时，内核段系统内存可以直接定位。

### defs.h

pinit初始化进程数组的锁。

yield主动让出CPU，有哪些场景？

### x86.h

为什么需要volatile?

stosb在内存中存储字符串。可不可以用c语言而不用汇编实现呢？

segdesc是否代表是段页式的实现？

lgdt/lidt讲解。

ltr/tss，外（用户态）跳内（内核态）需要使用。

CR0-CR3讲解。

### mmu.h

CR0_PE 是否处于保护模式

CR0_PG 是否开启分页

segdesc讲解：dpl权限等级。

### proc.h

20:CPU为什么需要持有自己？

20-41含义？

### proc.c

13:进程数组

17:0号进程

forkret？initlog?

allocproc中68-82？

growproc下一讲讲。

fork中：所有进程公用一个内核栈框tf？

190的panic函数参见console.c 110行

241wait一定在exit后调用吗？

305scheduler是最简单的遍历调度算法

wakeup是把wakeup1加锁包了一层

448kill是先设置标志位，后面唤醒

### swtch.S

11/12利用偏移获取函数参数。

4为什么**old, *new，old用指针的指针？

> 2020.10.18 讲解：zxm 记录： btz